---
title: 顶点动画
tags:
  - Shader
  - Shader基础
  - 动态效果
categories:
  - [技术美术, UnityShader, 动态效果]
author:
  - nightstardawn
---

# 顶点动画
## 零、前置知识
</br>是否对SubShader进行批处理
`Tags{"DisableBatching" = "True/false"}`
</br>我们在制作顶点动画时，有时需要关闭该Shader的批处理
</br>因为我们在制作顶点动画的时候，有时需要使用模型空间下的数据
</br>而批处理会合并所有相关的模型，这些模型各自的模型空间会消失，导致我们无法正确使用模型空间下的相关数据

## 一、2D河流动画

### 1.基本原理
利用类似于机械波的波函数公式，对顶点进行位置偏移
</br>`某轴的位置偏移量 = 波动幅度 * sin(_Time.y * 波动频率 + 顶点某位置坐标 * 波长倒数)`
</br>其中，具体轴向根据模型空间决定
</br>波动幅度、波动频率、波长倒数为可调节参数

**注意：**
</br>在实现2D河流效果时，我们需要让顶点在模型空间下进行偏移
</br>需要关闭批处理
`Tags{"DisableBatching" = "false"}`
观察资源模型空间的的轴向，是否符合Unity轴向标准
### 2.基本实现思路
1. 属性声明、映射
   1. 主纹理
   2. 叠加颜色
   3. 波动幅度
   4. 波动频率
   5. 波长的倒数
2. 透明Shader相关
   1. 渲染标签相关
   </br>`Tags{"RenderType" = "Transparent" "Queue" = "Transparent" "IgnoreProject" = "True" "DisableBatching" = "false"}`
   2. 关闭深度写入、透明度混合
   </br>`ZWrite off | Blend SrcAlpha OneMinusSrcAlpha`
3. 结构体相关
    </br>顶点、uv
4. 顶点着色器
   利用公式计算对应轴向偏移位置(模型空间中偏移)
5. 片元着色器
   直接进行颜色采样和颜色叠加

### 3.实现示例






















